<!-- Generated by Chef for <%= @node[:fqdn] %> -->
<Storage>
    <ClusterName><%= @node[:cassandra][:cluster_name] %></ClusterName>
    <AutoBootstrap><%= @node[:cassandra][:auto_bootstrap] %></AutoBootstrap>
    <Keyspaces>
        <% @node[:cassandra][:keyspaces].each_pair do |kname, keyspace| %>
        <Keyspace Name="<%= kname %>">
            <% keyspace[:columns].each_pair do |cname, column| %>
            <ColumnFamily Name="<%= cname %>" <%= (column.keys.map do |attrib|
                        (attrib.to_s.split('_').map do |part|
                            part.capitalize
                        end).join('') + "=\"" + column[attrib] + "\""
                    end).join(' ') %> />
            <% end %>
            <ReplicaPlacementStrategy><%= keyspace[:replica_placement_strategy] %></ReplicaPlacementStrategy>
            <ReplicationFactor><%= keyspace[:replication_factor] %></ReplicationFactor>
            <EndPointSnitch><%= keyspace[:end_point_snitch] %></EndPointSnitch>
        </Keyspace>
        <% end %>  
    </Keyspaces>
    <Authenticator><%= @node[:cassandra][:authenticator] %></Authenticator>
    <Partitioner><%= @node[:cassandra][:partitioner] %></Partitioner>
    <InitialToken><%= @node[:cassandra][:initial_token] %></InitialToken>
    <CommitLogDirectory><%= @node[:cassandra][:commit_log_dir] %></CommitLogDirectory>
    <DataFileDirectories>
        <% @node[:cassandra][:data_file_dirs].each do |dir| %>
        <DataFileDirectory><%= dir %></DataFileDirectory>
        <% end %>
    </DataFileDirectories>
    <CalloutLocation><%= @node[:cassandra][:callout_location] %></CalloutLocation>
    <StagingFileDirectory><%= @node[:cassandra][:staging_file_dir] %></StagingFileDirectory>
    <Seeds>
        <% @node[:cassandra][:seeds].each do |seed| %>
        <Seed><%= seed %></Seed>
        <% end %>
    </Seeds>
    <RpcTimeoutInMillis><%= @node[:cassandra][:rpc_timeout] %></RpcTimeoutInMillis>
    <CommitLogRotationThresholdInMB><%= @node[:cassandra][:commit_log_rotation_threshold] %></CommitLogRotationThresholdInMB>
    <ListenAddress><%= @node[:cassandra][:listen_addr] %></ListenAddress>
    <StoragePort><%= @node[:cassandra][:storage_port] %></StoragePort>
    <ThriftAddress><%= @node[:cassandra][:thrift_addr] %></ThriftAddress>
    <ThriftPort><%= @node[:cassandra][:thrift_port] %></ThriftPort>
    <ThriftFramedTransport><%= @node[:cassandra][:thrift_framed_transport] %></ThriftFramedTransport>
    <DiskAccessMode><%= @node[:cassandra][:disk_access_mode] %></DiskAccessMode>
    <SlicedBufferSizeInKB><%= @node[:cassandra][:sliced_buffer_size] %></SlicedBufferSizeInKB>
    <FlushDataBufferSizeInMB><%= @node[:cassandra][:flush_data_buffer_size] %></FlushDataBufferSizeInMB>
    <FlushIndexBufferSizeInMB><%= @node[:cassandra][:flush_index_buffer_size] %></FlushIndexBufferSizeInMB>
    <ColumnIndexSizeInKB><%= @node[:cassandra][:column_index_size] %></ColumnIndexSizeInKB>
    <MemtableThroughputInMB><%= @node[:cassandra][:memtable_throughput] %></MemtableThroughputInMB>
    <BinaryMemtableThroughputInMB><%= @node[:cassandra][:binary_memtable_throughput] %></BinaryMemtableThroughputInMB>
    <MemtableOperationsInMillions><%= @node[:cassandra][:memtable_ops] %></MemtableOperationsInMillions>
    <MemtableFlushAfterMinutes><%= @node[:cassandra][:memtable_flush_after] %></MemtableFlushAfterMinutes>
    <ConcurrentReads><%= @node[:cassandra][:concurrent_reads] %></ConcurrentReads>
    <ConcurrentWrites><%= @node[:cassandra][:concurrent_writes] %></ConcurrentWrites>
    <CommitLogSync><%= @node[:cassandra][:commit_log_sync] %></CommitLogSync>
    <CommitLogSyncPeriodInMS><%= @node[:cassandra][:commit_log_sync_period] %></CommitLogSyncPeriodInMS>
    <% unless @node[:cassandra][:commit_log_sync_batch_window].nil? %>
    <CommitLogSyncBatchWindowInMS><%= @node[:cassandra][:commit_log_sync_batch_window] %></CommitLogSyncBatchWindowInMS>
    <% end %>
    <GCGraceSeconds><%= @node[:cassandra][:gc_grace] %></GCGraceSeconds>
</Storage>